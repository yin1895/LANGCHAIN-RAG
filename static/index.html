<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <title>æ•°å­¦å»ºæ¨¡ RAG Demo By YIN</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root { --bg:#f5f7fa; --panel:#fff; --border:#e5e7eb; --text:#1f2937; --accent:#2563eb; --accent-hover:#1d4ed8; --muted:#6b7280; }
    :root[data-theme='dark'] { --bg:#0f172a; --panel:#1e293b; --border:#334155; --text:#f1f5f9; --accent:#3b82f6; --accent-hover:#60a5fa; --muted:#94a3b8; }
    body { font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial; margin:0; padding:0; background:var(--bg); color:var(--text); }
    header { background:linear-gradient(135deg,var(--accent),#9333ea); color:#fff; padding:14px 20px; display:flex; align-items:center; justify-content:space-between; }
    h1 { font-size:18px; margin:0; font-weight:600; letter-spacing:.5px; }
    main { display:flex; gap:16px; padding:16px; flex-wrap:wrap; }
    .panel { background:var(--panel); border:1px solid var(--border); border-radius:10px; padding:16px 18px; box-shadow:0 4px 8px rgba(0,0,0,.06); flex:1 1 340px; display:flex; flex-direction:column; min-width:300px; }
    .panel h2 { margin:0 0 12px; font-size:15px; font-weight:600; letter-spacing:.5px; text-transform:uppercase; color:var(--muted); }
    textarea { width:100%; min-height:90px; resize:vertical; padding:10px 12px; font-size:14px; line-height:1.5; border:1px solid var(--border); background:var(--bg); color:var(--text); border-radius:6px; }
    button { cursor:pointer; background:var(--accent); color:#fff; padding:8px 18px; border:none; border-radius:6px; font-size:14px; font-weight:500; transition:.15s; display:inline-flex; align-items:center; gap:6px; }
    button:hover:not(:disabled){ background:var(--accent-hover); }
    button:disabled { background:#94a3b8; cursor:not-allowed; opacity:.7; }
    .row { display:flex; gap:10px; align-items:center; margin:10px 0; flex-wrap:wrap; }
    .answer { white-space:pre-wrap; background:linear-gradient(145deg,var(--panel),var(--bg)); padding:14px 14px; border-radius:8px; font-size:14px; line-height:1.55; border:1px solid var(--border); flex:1; }
    .contexts { margin-top:12px; font-size:13px; }
    .ctx-item { background:var(--panel); border:1px solid var(--border); margin-bottom:10px; padding:6px 10px 10px; border-radius:6px; }
    .ctx-item summary { cursor:pointer; font-weight:500; }
    .small { font-size:12px; color:var(--muted); }
    footer { text-align:center; padding:20px 10px; font-size:12px; color:var(--muted); }
    input[type=number] { width:90px; padding:6px 8px; border:1px solid var(--border); border-radius:6px; background:var(--panel); color:var(--text); }
    input[type=checkbox] { transform:scale(1.1); }
    .status { font-size:12px; color:var(--muted); margin-left:8px; }
    .code { font-family: ui-monospace,Consolas,monospace; }
    #debug { max-height:240px; overflow:auto; background:#111; color:#ddd; padding:10px 12px; border-radius:8px; font-size:12px; line-height:1.4; }
    header button { background:rgba(255,255,255,.18); border:1px solid rgba(255,255,255,.35); padding:6px 12px; backdrop-filter:blur(4px); }
    header button:hover { background:rgba(255,255,255,.28); }
    @media (max-width: 980px){ main { flex-direction:column; } }
  </style>
</head>
<body>
  <header>
    <h1>æ•°å­¦å»ºæ¨¡ RAG system By YIN</h1>
    <div>
      <button id="themeToggle" title="åˆ‡æ¢ä¸»é¢˜">ğŸŒ— ä¸»é¢˜</button>
    </div>
  </header>
  <main>
    <div class="panel" style="max-width:420px;">
      <h2>é—®ç­”</h2>
      <label>é—®é¢˜ï¼š</label>
      <textarea id="question" placeholder="è¯·è¾“å…¥ä½ çš„é—®é¢˜ï¼Œä¾‹å¦‚ï¼šåœ¨è§„åˆ’é—®é¢˜ä¸Šï¼Œå¦‚ä½•é¿å…è¿‡åº¦æ‹Ÿåˆä¸€ä¸ªç»“æœï¼Ÿ"></textarea>
      <div class="row">
        <label>Top-K</label>
        <input type="number" id="topk" value="6" min="1" max="15" />
        <label>BM25</label>
        <input type="number" id="bm25" value="0.35" min="0" max="1" step="0.05" />
        <label><input type="checkbox" id="includeContent" checked />ç‰‡æ®µå†…å®¹</label>
      </div>
      <div class="row">
        <button id="askBtn">æé—®</button>
        <span class="status" id="askStatus"></span>
      </div>
      <div class="answer" id="answer" placeholder="å›ç­”å±•ç¤ºåŒº"></div>
    </div>
  <div class="panel" id="panel-contexts">
      <h2>å¼•ç”¨ç‰‡æ®µ</h2>
      <div id="contexts" class="contexts"></div>
    </div>
    <div class="panel" style="max-width:320px;" id="panel-manage">
      <h2>ç´¢å¼•ç®¡ç†</h2>
      <button id="ingestBtn">æ‰§è¡Œ /ingest</button>
      <span class="status" id="ingestStatus"></span>
      <div style="margin-top:12px;" class="small">
        /ingest åªä¼šä¸ºæ–°å¢å†…å®¹åµŒå…¥å‘é‡ã€‚å¦‚æœä¿®æ”¹æ—§æ–‡æ¡£å¹¶æƒ³å…¨é‡é‡å»ºï¼Œæ‰‹åŠ¨åˆ é™¤ vector_store ç›®å½•å†ç‚¹æ‰§è¡Œã€‚ä¸æ‡‚åˆ«ç‚¹å°±å¯¹äº†ï¼Œå¦‚æœæœ¬åœ°åµŒå…¥å®¹æ˜“å´©æºƒ
      </div>
      <h2 style="margin-top:24px;">è°ƒè¯•</h2>
      <div id="debug" class="small code"></div>
    </div>
  </main>
  <footer>å½“å‰é¡µé¢ä¸ºä¸“é—¨ä¸ºyinå’Œgcå°é˜Ÿè®¾è®¡çš„äº¤äº’é¡µé¢</footer>
  <script type="module">
    import { initApp } from '/static/app.js';
    initApp();
  </script>
</body>
</html>
